
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>EDA y ETL: Conjunto de datos 1 &#8212; Delitos en Barranquilla</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Informe';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Modelo de Machine learning" href="Modelo.html" />
    <link rel="prev" title="Contextualización del proyecto" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Delitos en Barranquilla - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Delitos en Barranquilla - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Contextualización del proyecto
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>EDA y ETL: Conjunto de datos 1</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="Modelo.html"><strong>Modelo de Machine learning</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Informe2.html"><strong>EDA y ETL: Conjunto de datos 2 y 3</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Manual.html"><strong>Manual de usuario: BOT</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Mejoras.html"><strong>Posibles mejoras del proyecto</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/kmarcela11/DelitosBarranquilla" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/kmarcela11/DelitosBarranquilla/issues/new?title=Issue%20on%20page%20%2FInforme.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Informe.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>EDA y ETL: Conjunto de datos 1</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>EDA y ETL: Conjunto de datos 1</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias-y-modulos-necesarios"><strong>Librerías y modulos necesarios</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conjunto-de-datos-1"><strong>Conjunto de datos 1</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contextualizacion-de-los-datos"><strong>Contextualización de los datos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#caracteristicas-de-los-datos"><strong>Características de los datos</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformacion-limpieza-y-reorganizacion-del-conjunto-de-datos"><strong>Transformación, limpieza y reorganización del conjunto de datos</strong></a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="eda-y-etl-conjunto-de-datos-1">
<h1><strong>EDA y ETL: Conjunto de datos 1</strong><a class="headerlink" href="#eda-y-etl-conjunto-de-datos-1" title="Link to this heading">#</a></h1>
<p>Es importante destacar que, para una persona no experta en datos interesada en conocer la situación de los delitos en su ciudad, la comprensión de este conjunto de datos puede resultar complicada, ya que se presenta como una comparación entre periodos de tiempo. Dado que nuestro objetivo es aprovechar los datos abiertos de la manera más efectiva, llevaremos a cabo una reestructuración de este conjunto de datos. Esta transformación buscará simplificar su interpretación y hacerlo más accesible, asegurando que cualquier persona pueda entender fácilmente la información presentada.</p>
<section id="librerias-y-modulos-necesarios">
<h2><strong>Librerías y modulos necesarios</strong><a class="headerlink" href="#librerias-y-modulos-necesarios" title="Link to this heading">#</a></h2>
<p>Las librerías necesarias para el desarrollo del análisis exploratorio y transformación de datos son las siguientes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="conjunto-de-datos-1">
<h1><strong>Conjunto de datos 1</strong><a class="headerlink" href="#conjunto-de-datos-1" title="Link to this heading">#</a></h1>
<p>Inicialmente hacemos cargue del conjunto de datos a usar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;C:\Users\kamac\OneDrive\Desktop\DelitosBarranquilla\comparativo_de_delitos.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="contextualizacion-de-los-datos">
<h2><strong>Contextualización de los datos</strong><a class="headerlink" href="#contextualizacion-de-los-datos" title="Link to this heading">#</a></h2>
<p>Este conjunto de datos presenta un consolidado de delitos de alto impacto ocurridos en la ciudad de Barranquilla. Incluye cifras preliminares de homicidios, denuncias por extorsión, lesiones personales, delitos sexuales, violencia intrafamiliar y diversos tipos de hurto, como hurto a personas, comercios, residencias, entidades financieras, automotores y motocicletas. Además, proporciona una comparación entre el mismo periodo de diferentes años, destacando las variaciones porcentuales (%) y absolutas (#), lo que permite un análisis detallado de las tendencias y cambios en la incidencia de estos delitos a lo largo del tiempo. Este conjunto de datos constituye una herramienta valiosa para comprender la dinámica delictiva en Barranquilla y diseñar estrategias de prevención basadas en evidencia.</p>
<p>El conjunto de datos se encuentra en el siguiente enlace: <a class="reference external" href="https://www.datos.gov.co/Seguridad-y-Defensa/Comparativo-de-delitos-de-alto-impacto-en-la-ciuda/4p95-h82w/about_data">Comparativo de delitos de alto impacto en la ciudad de Barranquilla</a></p>
<section id="caracteristicas-de-los-datos">
<h3><strong>Características de los datos</strong><a class="headerlink" href="#caracteristicas-de-los-datos" title="Link to this heading">#</a></h3>
<p>Ahora se visualizan las primeras cinco observaciones del conjunto de datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Periodo meses comparado</th>
      <th>Años comparados</th>
      <th>Delito</th>
      <th>Casos/denuncias  anterior periodo</th>
      <th>Casos/denuncias último periodo</th>
      <th>Variación %</th>
      <th>Variación absoluta</th>
      <th>Fuente</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>01 al 31 de enero</td>
      <td>2019-2020</td>
      <td>Homicidios</td>
      <td>25</td>
      <td>23</td>
      <td>-8%</td>
      <td>-2</td>
      <td>POLICIA MEBAR-GRICRI,datos extraidos del balan...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>01 al 31 de enero</td>
      <td>2019-2020</td>
      <td>Lesiones personales o comunes</td>
      <td>279</td>
      <td>186</td>
      <td>-33%</td>
      <td>-93</td>
      <td>POLICIA MEBAR-GRICRI,datos extraidos del balan...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>01 al 31 de enero</td>
      <td>2019-2020</td>
      <td>Hurtos a personas</td>
      <td>892</td>
      <td>944</td>
      <td>6%</td>
      <td>52</td>
      <td>POLICIA MEBAR-GRICRI,datos extraidos del balan...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>01 al 31 de enero</td>
      <td>2019-2020</td>
      <td>Hurtos a comercios</td>
      <td>171</td>
      <td>59</td>
      <td>-65%</td>
      <td>-112</td>
      <td>POLICIA MEBAR-GRICRI,datos extraidos del balan...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>01 al 31 de enero</td>
      <td>2019-2020</td>
      <td>Hurtos a residencias</td>
      <td>85</td>
      <td>50</td>
      <td>-41%</td>
      <td>-35</td>
      <td>POLICIA MEBAR-GRICRI,datos extraidos del balan...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(427, 8)
</pre></div>
</div>
</div>
</div>
<p>El conjunto de datos inicial cuenta con <strong>427</strong> observaciones y <strong>8</strong> variables.</p>
</section>
</section>
<section id="transformacion-limpieza-y-reorganizacion-del-conjunto-de-datos">
<h2><strong>Transformación, limpieza y reorganización del conjunto de datos</strong><a class="headerlink" href="#transformacion-limpieza-y-reorganizacion-del-conjunto-de-datos" title="Link to this heading">#</a></h2>
<p>Inicialmente, se eliminó la columna correspondiente a <strong>“Fuente”</strong>, ya que no será relevante para el desarrollo del tablero de visualización. No obstante, es importante mencionar que la fuente de los datos es <strong>“POLICÍA MEBAR-GRICRI”</strong>, y los mismos fueron extraídos del balance criminológico, garantizando la veracidad y confiabilidad de la información utilizada.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Fuente&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>En este proceso, se reorganizan y preparan los datos para facilitar su análisis. Primero, la columna <strong>“Años comparados”</strong> se divide en dos nuevas columnas, <strong>“Año anterior”</strong> y <strong>“Último año”</strong>, separando la información de los años comparados. Luego, se elimina la columna original <strong>“Años comparados”</strong> al no ser necesaria tras la división. Finalmente, las columnas del DataFrame se reorganizan para mejorar su legibilidad, destacando información clave como el periodo comparado, los tipos de delitos, el número de casos en cada año y las variaciones porcentuales y absolutas. Este proceso da como resultado una estructura más clara y lógica que facilita la interpretación de los datos y el análisis de tendencias delictivas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dividir la columna &#39;Años comparados&#39; en &#39;Año anterior&#39; y &#39;Último año&#39;</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Año anterior&#39;</span><span class="p">,</span> <span class="s1">&#39;Último año&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Años comparados&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Eliminar la columna &#39;Años comparados&#39; original</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Años comparados&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Reorganizar las columnas para que las nuevas columnas estén en el lugar adecuado</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Periodo meses comparado&#39;</span><span class="p">,</span> <span class="s1">&#39;Año anterior&#39;</span><span class="p">,</span> <span class="s1">&#39;Último año&#39;</span><span class="p">,</span> <span class="s1">&#39;Delito&#39;</span><span class="p">,</span> 
         <span class="s1">&#39;Casos/denuncias  anterior periodo&#39;</span><span class="p">,</span> <span class="s1">&#39;Casos/denuncias último periodo&#39;</span><span class="p">,</span> 
         <span class="s1">&#39;Variación %&#39;</span><span class="p">,</span> <span class="s1">&#39;Variación absoluta&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Periodo meses comparado&#39;</span><span class="p">:</span> <span class="s1">&#39;Meses comparados&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Casos/denuncias  anterior periodo&#39;</span><span class="p">:</span> <span class="s1">&#39;Casos anterior año&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Casos/denuncias último periodo&#39;</span><span class="p">:</span> <span class="s1">&#39;Casos último año&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Variación %&#39;</span><span class="p">:</span> <span class="s1">&#39;Variacion porcentual&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Variación absoluta&#39;</span><span class="p">:</span> <span class="s1">&#39;Variacion absoluta&#39;</span>
<span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Para manejar la duplicidad de categorías debido a diferencias en mayúsculas y minúsculas, se aplica una transformación a la columna <strong>“Delito”</strong> utilizando una función lambda. Esta transformación estandariza los nombres de las categorías, agrupando aquellas que tienen el mismo significado pero están escritas de forma diferente (por ejemplo, en mayúsculas o con variaciones en su redacción). La función busca palabras clave en cada valor de la columna, las convierte a minúsculas con <code class="docutils literal notranslate"><span class="pre">.lower()</span></code> y asigna un nombre unificado a las categorías. Esto garantiza consistencia en los datos y facilita el análisis posterior al eliminar redundancias y garantizar que cada categoría represente un único tipo de delito.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aplicar la transformación usando lambda para agrupar las categorías repetidas</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Delito&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Delito&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;Delitos sexuales&#39;</span> <span class="k">if</span> <span class="s1">&#39;delito&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;sexuales&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">else</span> <span class="p">(</span>
    <span class="s1">&#39;Hurtos a comercios&#39;</span> <span class="k">if</span> <span class="s1">&#39;hurto a comer&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">else</span> <span class="p">(</span>
    <span class="s1">&#39;Hurtos a personas&#39;</span> <span class="k">if</span> <span class="s1">&#39;hurto a persona&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;hurto a personas&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">else</span> <span class="p">(</span>
    <span class="s1">&#39;Hurtos de motocicletas&#39;</span> <span class="k">if</span> <span class="s1">&#39;hurto motocicletas&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;hurto a motocicletas&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;hurtos motocicletas&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">else</span> <span class="p">(</span>
    <span class="s1">&#39;Hurtos a residencias&#39;</span> <span class="k">if</span> <span class="s1">&#39;hurto a residencias&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">else</span> <span class="p">(</span>
    <span class="s1">&#39;Hurtos automotores&#39;</span> <span class="k">if</span> <span class="s1">&#39;hurto automotores&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;hurto a automotores&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">else</span> <span class="p">(</span>
    <span class="s1">&#39;Lesiones personales o comunes&#39;</span> <span class="k">if</span> <span class="s1">&#39;lesiones personales&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">else</span> <span class="p">(</span>
    <span class="s1">&#39;Extorsión&#39;</span> <span class="k">if</span> <span class="s1">&#39;extorsión&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">else</span> <span class="p">(</span>
    <span class="s1">&#39;Violencia intrafamiliar&#39;</span> <span class="k">if</span> <span class="s1">&#39;violencia intrafamiliar&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">else</span> <span class="p">(</span>
    <span class="s1">&#39;Hurtos a entidades financieras&#39;</span> <span class="k">if</span> <span class="s1">&#39;hurto a entidades financieras&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;hurto a entidad financiera&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">else</span> <span class="p">(</span>
    <span class="s1">&#39;Hurtos a residencias&#39;</span> <span class="k">if</span> <span class="s1">&#39;hurto a residencia&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">else</span> <span class="p">(</span>
    <span class="s1">&#39;Hurtos de bicicletas&#39;</span> <span class="k">if</span> <span class="s1">&#39;hurto a bicicletas&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">else</span> <span class="p">(</span>
    <span class="s1">&#39;Hurtos de celulares&#39;</span> <span class="k">if</span> <span class="s1">&#39;hurto a celulares&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span><span class="p">)))))))))))))</span>
</pre></div>
</div>
</div>
</div>
<p>Entonces, los delitos que encontramos en la base de datos son los siguentes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="s1">&#39;Delito&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Delito
Homicidios                        47
Hurtos a comercios                47
Hurtos a personas                 47
Hurtos a residencias              47
Hurtos automotores                47
Hurtos de motocicletas            47
Lesiones personales o comunes     47
Hurtos a entidades financieras    32
Extorsión                         26
Delitos sexuales                  15
Violencia intrafamiliar           15
Hurtos de bicicletas               5
Hurtos de celulares                5
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Ahora, haremos una transformación por cada delito.</p>
<p>En este bloque de código se realiza una transformación específica para el delito de <strong>homicidios</strong>, pero este proceso es aplicable a todos los delitos mencionados previamente (delitos sexuales, extorsión, violencia intrafamiliar, hurtos a personas, comercios, residencias, entidades financieras, automotores, motocicletas, bicicletas y celulares). A continuación, se describe lo que se realiza:</p>
<ol class="arabic simple">
<li><p><strong>Filtrado por delito específico</strong>:</p>
<ul class="simple">
<li><p>Se seleccionan únicamente las filas correspondientes al delito de interés, en este caso, <strong>homicidios</strong>.</p></li>
</ul>
</li>
<li><p><strong>Extracción y limpieza de datos</strong>:</p>
<ul class="simple">
<li><p>Se extrae el nombre del mes desde la columna <strong>“Meses comparados”</strong> para obtener una columna separada con el nombre del mes.</p></li>
<li><p>La primera letra de cada mes se convierte en mayúscula para estandarizar el formato.</p></li>
</ul>
</li>
<li><p><strong>Conversión de columnas numéricas</strong>:</p>
<ul class="simple">
<li><p>Se convierten las columnas <strong>“Casos anterior año”</strong> y <strong>“Casos último año”</strong> a valores numéricos para permitir cálculos matemáticos posteriores.</p></li>
</ul>
</li>
<li><p><strong>Cálculo de casos mensuales</strong>:</p>
<ul class="simple">
<li><p>Se crean nuevas columnas que calculan la diferencia de los casos de cada mes dentro de los años respectivos, asegurando que se puedan comparar de manera precisa.</p></li>
</ul>
</li>
<li><p><strong>Cálculo de variaciones</strong>:</p>
<ul class="simple">
<li><p>Se calcula la variación absoluta entre los casos del año anterior y los del último año.</p></li>
<li><p>Se calcula la variación porcentual, mostrando cómo ha cambiado el número de casos entre ambos años.</p></li>
</ul>
</li>
<li><p><strong>Renombrado y reorganización de columnas</strong>:</p>
<ul class="simple">
<li><p>Las columnas se renombran para que sean más descriptivas.</p></li>
<li><p>Se reorganizan para mejorar la legibilidad y facilitar la exportación.</p></li>
</ul>
</li>
<li><p><strong>Conversión a enteros y exportación</strong>:</p>
<ul class="simple">
<li><p>Las columnas numéricas se convierten a enteros eliminando los decimales, y los resultados se exportan a un archivo CSV con los datos ya ordenados y procesados.</p></li>
</ul>
</li>
</ol>
<p>Este proceso permite organizar y analizar los datos de manera detallada para cada delito, estandarizando los cálculos y dejando los datos listos para su interpretación y visualización en herramientas como Power BI.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_homicidios</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Delito&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Homicidios&#39;</span><span class="p">]</span>
<span class="c1"># Extraer solo el mes de &quot;Meses comparados&quot; tomando la última palabra</span>
<span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Mes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Meses comparados&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Convertir la primera letra de cada mes a mayúscula</span>
<span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Mes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Mes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>

<span class="c1"># Convertir las columnas de &quot;Casos&quot; a valores numéricos</span>
<span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos anterior año&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos anterior año&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos último año&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos último año&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

<span class="c1"># Crear una nueva columna con la diferencia de los casos mensuales para el año anterior</span>
<span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos mensuales anterior año&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos anterior año&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos anterior año&#39;</span><span class="p">])</span>

<span class="c1"># Crear una nueva columna con la diferencia de los casos mensuales para el último año</span>
<span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos mensuales último año&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos último año&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos último año&#39;</span><span class="p">])</span>

<span class="c1"># Agrupar por &quot;Año anterior&quot; para asegurar que la diferencia se calcule correctamente dentro de cada año</span>
<span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos mensuales anterior año&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_homicidios</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Año anterior&#39;</span><span class="p">)[</span><span class="s1">&#39;Casos anterior año&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos anterior año&#39;</span><span class="p">])</span>
<span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos mensuales último año&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_homicidios</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Año anterior&#39;</span><span class="p">)[</span><span class="s1">&#39;Casos último año&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos último año&#39;</span><span class="p">])</span>

<span class="c1"># Eliminar las columnas que no son necesarias para el análisis</span>
<span class="n">df_homicidios</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Meses comparados&#39;</span><span class="p">,</span> <span class="s1">&#39;Casos anterior año&#39;</span><span class="p">,</span> <span class="s1">&#39;Casos último año&#39;</span><span class="p">],</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Renombrar las columnas para que sean más descriptivas</span>
<span class="n">df_homicidios</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;Casos mensuales anterior año&#39;</span><span class="p">:</span> <span class="s1">&#39;Casos Mensuales Año Anterior&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Casos mensuales último año&#39;</span><span class="p">:</span> <span class="s1">&#39;Casos Mensuales Último Año&#39;</span>
<span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Calcular la variación absoluta</span>
<span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Variacion absoluta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos Mensuales Último Año&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos Mensuales Año Anterior&#39;</span><span class="p">]</span>

<span class="c1"># Calcular la variación porcentual</span>
<span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Variacion porcentual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos Mensuales Último Año&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos Mensuales Año Anterior&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Casos Mensuales Año Anterior&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Variacion porcentual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_homicidios</span><span class="p">[</span><span class="s1">&#39;Variacion porcentual&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Reubicar las columnas en el orden que prefieras</span>
<span class="n">df_homicidios</span> <span class="o">=</span> <span class="n">df_homicidios</span><span class="p">[[</span><span class="s1">&#39;Mes&#39;</span><span class="p">,</span> <span class="s1">&#39;Año anterior&#39;</span><span class="p">,</span> <span class="s1">&#39;Último año&#39;</span><span class="p">,</span> <span class="s1">&#39;Delito&#39;</span><span class="p">,</span> <span class="s1">&#39;Casos Mensuales Año Anterior&#39;</span><span class="p">,</span> <span class="s1">&#39;Casos Mensuales Último Año&#39;</span><span class="p">,</span> <span class="s1">&#39;Variacion porcentual&#39;</span><span class="p">,</span> <span class="s1">&#39;Variacion absoluta&#39;</span><span class="p">]]</span>

<span class="c1"># Seleccionamos las columnas numéricas (excepto las categóricas y las de los años)</span>
<span class="n">numerical_columns</span> <span class="o">=</span> <span class="n">df_homicidios</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># Convertimos esas columnas a enteros (eliminando los decimales)</span>
<span class="n">df_homicidios</span><span class="p">[</span><span class="n">numerical_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_homicidios</span><span class="p">[</span><span class="n">numerical_columns</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">df_homicidios</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C:\Users\kamac\OneDrive\Desktop\DelitosBarranquilla\homicidios_ordenados.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Cabe destacar que, en este caso, el proceso se muestra únicamente para la categoría de <strong>homicidios</strong> con el objetivo de mejorar la claridad y visibilidad del informe. No obstante, este mismo procedimiento fue aplicado de manera consistente a cada uno de los tipos de delitos mencionados anteriormente, garantizando un análisis detallado y uniforme para todas las categorías incluidas en el conjunto de datos.</p>
<p>Ahora, importamos cada base de datos generada por la transformación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_homicidios</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">kamac</span><span class="se">\\</span><span class="s2">OneDrive</span><span class="se">\\</span><span class="s2">Desktop</span><span class="se">\\</span><span class="s2">DelitosBarranquilla</span><span class="se">\\</span><span class="s2">homicidios_ordenados.csv&quot;</span><span class="p">)</span>
<span class="n">df_hurtos_comercios</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">kamac</span><span class="se">\\</span><span class="s2">OneDrive</span><span class="se">\\</span><span class="s2">Desktop</span><span class="se">\\</span><span class="s2">DelitosBarranquilla</span><span class="se">\\</span><span class="s2">hurtos_comercios_ordenados.csv&quot;</span><span class="p">)</span>
<span class="n">df_hurtos_personas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">kamac</span><span class="se">\\</span><span class="s2">OneDrive</span><span class="se">\\</span><span class="s2">Desktop</span><span class="se">\\</span><span class="s2">DelitosBarranquilla</span><span class="se">\\</span><span class="s2">hurtos_personas_ordenados.csv&quot;</span><span class="p">)</span>
<span class="n">df_hurtos_residencias</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">kamac</span><span class="se">\\</span><span class="s2">OneDrive</span><span class="se">\\</span><span class="s2">Desktop</span><span class="se">\\</span><span class="s2">DelitosBarranquilla</span><span class="se">\\</span><span class="s2">hurtos_residencias_ordenados.csv&quot;</span><span class="p">)</span>
<span class="n">df_hurtos_automotores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">kamac</span><span class="se">\\</span><span class="s2">OneDrive</span><span class="se">\\</span><span class="s2">Desktop</span><span class="se">\\</span><span class="s2">DelitosBarranquilla</span><span class="se">\\</span><span class="s2">hurtos_automotores_ordenados.csv&quot;</span><span class="p">)</span>
<span class="n">df_hurtos_motocicletas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">kamac</span><span class="se">\\</span><span class="s2">OneDrive</span><span class="se">\\</span><span class="s2">Desktop</span><span class="se">\\</span><span class="s2">DelitosBarranquilla</span><span class="se">\\</span><span class="s2">hurtos_motocicletas_ordenados.csv&quot;</span><span class="p">)</span>
<span class="n">df_lesiones_personales</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">kamac</span><span class="se">\\</span><span class="s2">OneDrive</span><span class="se">\\</span><span class="s2">Desktop</span><span class="se">\\</span><span class="s2">DelitosBarranquilla</span><span class="se">\\</span><span class="s2">lesiones_personales_ordenados.csv&quot;</span><span class="p">)</span>
<span class="n">df_extorsion</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">kamac</span><span class="se">\\</span><span class="s2">OneDrive</span><span class="se">\\</span><span class="s2">Desktop</span><span class="se">\\</span><span class="s2">DelitosBarranquilla</span><span class="se">\\</span><span class="s2">extorsion_ordenados.csv&quot;</span><span class="p">)</span>
<span class="n">df_delitos_sexuales</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">kamac</span><span class="se">\\</span><span class="s2">OneDrive</span><span class="se">\\</span><span class="s2">Desktop</span><span class="se">\\</span><span class="s2">DelitosBarranquilla</span><span class="se">\\</span><span class="s2">delitos_sexuales_ordenados.csv&quot;</span><span class="p">)</span>
<span class="n">df_violencia_intrafamiliar</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">kamac</span><span class="se">\\</span><span class="s2">OneDrive</span><span class="se">\\</span><span class="s2">Desktop</span><span class="se">\\</span><span class="s2">DelitosBarranquilla</span><span class="se">\\</span><span class="s2">violencia_intrafamiliar_ordenados.csv&quot;</span><span class="p">)</span>
<span class="n">df_hurtos_bicicletas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">kamac</span><span class="se">\\</span><span class="s2">OneDrive</span><span class="se">\\</span><span class="s2">Desktop</span><span class="se">\\</span><span class="s2">DelitosBarranquilla</span><span class="se">\\</span><span class="s2">hurtos_bicicletas_ordenados.csv&quot;</span><span class="p">)</span>
<span class="n">df_hurtos_celulares</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">kamac</span><span class="se">\\</span><span class="s2">OneDrive</span><span class="se">\\</span><span class="s2">Desktop</span><span class="se">\\</span><span class="s2">DelitosBarranquilla</span><span class="se">\\</span><span class="s2">hurtos_celulares_ordenados.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Se unen cada base de datos de tipo de delitos en una sola llamada <code class="docutils literal notranslate"><span class="pre">df_total</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Concatenar todos los DataFrames en uno solo</span>
<span class="n">df_total</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
    <span class="n">df_homicidios</span><span class="p">,</span>
    <span class="n">df_hurtos_comercios</span><span class="p">,</span>
    <span class="n">df_hurtos_personas</span><span class="p">,</span>
    <span class="n">df_hurtos_residencias</span><span class="p">,</span>
    <span class="n">df_hurtos_automotores</span><span class="p">,</span>
    <span class="n">df_hurtos_motocicletas</span><span class="p">,</span>
    <span class="n">df_lesiones_personales</span><span class="p">,</span>
    <span class="n">df_extorsion</span><span class="p">,</span>
    <span class="n">df_delitos_sexuales</span><span class="p">,</span>
    <span class="n">df_violencia_intrafamiliar</span><span class="p">,</span>
    <span class="n">df_hurtos_bicicletas</span><span class="p">,</span>
    <span class="n">df_hurtos_celulares</span>
<span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>En este bloque de código se limpia y ajusta el conjunto de datos consolidado. Primero, se eliminan todas las filas que contienen valores faltantes (<em>NaN</em>) utilizando <code class="docutils literal notranslate"><span class="pre">dropna()</span></code>, asegurando que los datos estén completos. Luego, se identifican las columnas numéricas de tipo <code class="docutils literal notranslate"><span class="pre">float64</span></code> con <code class="docutils literal notranslate"><span class="pre">select_dtypes</span></code> y se convierten a enteros (<code class="docutils literal notranslate"><span class="pre">int</span></code>) para eliminar los decimales, lo cual es útil en análisis donde no se necesitan valores fraccionarios, como el conteo de casos. Finalmente, con <code class="docutils literal notranslate"><span class="pre">df_total.shape</span></code>, se verifica que el DataFrame resultante contiene <strong>330 filas</strong> y <strong>8 columnas</strong>, indicando que los datos están limpios y listos para su análisis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Eliminar filas con valores NaN</span>
<span class="n">df_total</span> <span class="o">=</span> <span class="n">df_total</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Seleccionar las columnas numéricas</span>
<span class="n">numerical_columns</span> <span class="o">=</span> <span class="n">df_total</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># Convertir las columnas numéricas a enteros, eliminando los decimales</span>
<span class="n">df_total</span><span class="p">[</span><span class="n">numerical_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_total</span><span class="p">[</span><span class="n">numerical_columns</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_total</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(330, 8)
</pre></div>
</div>
</div>
</div>
<p>Dado que, según la estructura de los datos, los casos del año <strong>2023</strong> se encuentran en la columna <strong>“Último año”</strong>, mientras que los casos de años anteriores están en la columna <strong>“Año anterior”</strong>, se procede a separar y filtrar la información. Primero, se crea un DataFrame filtrado (<code class="docutils literal notranslate"><span class="pre">df_filtered</span></code>) con las columnas relevantes para los casos de años anteriores. Luego, se extraen únicamente los registros correspondientes al año <strong>2023</strong> en un nuevo DataFrame (<code class="docutils literal notranslate"><span class="pre">df_2023</span></code>). Este último conserva las columnas específicas de <strong>mes</strong>, <strong>año</strong>, <strong>delito</strong>, y los <strong>casos mensuales del último año</strong>, lo que permite analizar los casos del año más reciente de manera independiente. Esto asegura que la información esté correctamente segmentada para facilitar su análisis y comparación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_filtered</span> <span class="o">=</span> <span class="n">df_total</span><span class="p">[[</span><span class="s1">&#39;Mes&#39;</span><span class="p">,</span> <span class="s1">&#39;Año anterior&#39;</span><span class="p">,</span> <span class="s1">&#39;Delito&#39;</span><span class="p">,</span> <span class="s1">&#39;Casos Mensuales Año Anterior&#39;</span><span class="p">]]</span>
<span class="n">df_2023</span> <span class="o">=</span> <span class="n">df_total</span><span class="p">[</span><span class="n">df_total</span><span class="p">[</span><span class="s1">&#39;Último año&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2023</span><span class="p">]</span>
<span class="n">df_2023</span> <span class="o">=</span> <span class="n">df_2023</span><span class="p">[[</span><span class="s1">&#39;Mes&#39;</span><span class="p">,</span> <span class="s1">&#39;Último año&#39;</span><span class="p">,</span><span class="s1">&#39;Delito&#39;</span><span class="p">,</span> <span class="s1">&#39;Casos Mensuales Último Año&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2023</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;Mes&#39;</span><span class="p">:</span> <span class="s1">&#39;Mes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Último año&#39;</span><span class="p">:</span> <span class="s1">&#39;Año anterior&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Delito&#39;</span><span class="p">:</span> <span class="s1">&#39;Delito&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Casos Mensuales Último Año&#39;</span><span class="p">:</span> <span class="s1">&#39;Casos Mensuales Año Anterior&#39;</span>
<span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>En este bloque de código, se integran los datos del año <strong>2023</strong> con los de años anteriores para crear un DataFrame consolidado. Primero, las columnas de <code class="docutils literal notranslate"><span class="pre">df_2023</span></code> se renombran para que coincidan con la estructura de <code class="docutils literal notranslate"><span class="pre">df_filtered</span></code>, lo que asegura consistencia en los nombres de las columnas. Luego, ambos DataFrames se concatenan utilizando <code class="docutils literal notranslate"><span class="pre">pd.concat</span></code>, generando un único conjunto de datos (<code class="docutils literal notranslate"><span class="pre">df_final</span></code>) con todos los años de análisis. Finalmente, se ajustan los valores en la columna <strong>“Casos Mensuales Año Anterior”</strong>, reemplazando posibles valores negativos por 0 mediante una función <code class="docutils literal notranslate"><span class="pre">lambda</span></code>, garantizando datos coherentes y listos para su análisis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_filtered</span><span class="p">,</span> <span class="n">df_2023</span><span class="p">],</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Casos Mensuales Año Anterior&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Casos Mensuales Año Anterior&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>En este paso, se renombran las columnas del DataFrame consolidado (<code class="docutils literal notranslate"><span class="pre">df_final</span></code>) para hacerlas más claras y descriptivas. Por ejemplo, <strong>“Año anterior”</strong> se cambia a <strong>“Año”</strong> y <strong>“Casos Mensuales Año Anterior”</strong> se convierte en <strong>“Cantidad de casos”</strong>, lo que facilita la interpretación de los datos. Este cambio asegura que los nombres de las columnas sean más intuitivos y adecuados para su análisis y visualización, mejorando la legibilidad del conjunto de datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;Mes&#39;</span><span class="p">:</span> <span class="s1">&#39;Mes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Año anterior&#39;</span><span class="p">:</span> <span class="s1">&#39;Año&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Delito&#39;</span><span class="p">:</span> <span class="s1">&#39;Delito&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Casos Mensuales Año Anterior&#39;</span><span class="p">:</span> <span class="s1">&#39;Cantidad de casos&#39;</span>
<span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Este proceso transforma el conjunto de datos para que sea compatible y óptimo para su uso en <strong>Power BI</strong>, asegurando un manejo eficiente y visualmente claro. Se realiza un mapeo de los meses a valores numéricos y se crea una columna de <strong>“Fecha”</strong> combinando el año, el mes y un día estándar (“01”), permitiendo trabajar con fechas en un formato adecuado para gráficos de series temporales. Además, se eliminan columnas intermedias y originales como <strong>“Mes”</strong> y <strong>“Año”</strong>, se reorganizan las columnas para priorizar <strong>“Fecha”</strong>, <strong>“Delito”</strong> y <strong>“Cantidad de casos”</strong>, y se reemplazan valores negativos en los datos por 0. Finalmente, el conjunto de datos procesado se exporta a un archivo CSV, listo para ser utilizado en tableros de visualización en Power BI.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crear un mapeo para los meses</span>
<span class="n">meses</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Enero&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Febrero&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Marzo&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Abril&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Mayo&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s2">&quot;Junio&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;Julio&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;Agosto&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;Septiembre&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;Octubre&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;Noviembre&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;Diciembre&quot;</span><span class="p">:</span> <span class="mi">12</span>
<span class="p">}</span>

<span class="c1"># Convertir el mes a número usando el mapeo</span>
<span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Mes_numero&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Mes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">meses</span><span class="p">)</span>

<span class="c1"># Crear una nueva columna de fecha con el formato Año-Mes</span>
<span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Año&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Mes_numero&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-01&#39;</span><span class="p">)</span>

<span class="c1"># Ahora puedes eliminar las columnas adicionales si ya no las necesitas</span>
<span class="n">df_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Mes_numero&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Reemplazar los valores negativos en &#39;Cantidad de casos&#39; por 0 (si es necesario)</span>
<span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Cantidad de casos&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Cantidad de casos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>

<span class="c1"># Crear la columna &#39;Fecha&#39; con solo el año y el mes</span>
<span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>

<span class="c1"># Eliminar las columnas originales &#39;Mes&#39; y &#39;Año&#39;</span>
<span class="n">df_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Mes&#39;</span><span class="p">,</span> <span class="s1">&#39;Año&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Reorganizar las columnas, poniendo &#39;Fecha&#39; al principio</span>
<span class="n">df_final</span> <span class="o">=</span> <span class="n">df_final</span><span class="p">[[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">,</span> <span class="s1">&#39;Delito&#39;</span><span class="p">,</span> <span class="s1">&#39;Cantidad de casos&#39;</span><span class="p">]]</span>

<span class="c1"># Exportar el DataFrame df_final a la ruta especificada</span>
<span class="n">df_final</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C:\Users\kamac\OneDrive\Desktop\DelitosBarranquilla\df_final.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Contextualización del proyecto</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="Modelo.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Modelo de Machine learning</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>EDA y ETL: Conjunto de datos 1</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias-y-modulos-necesarios"><strong>Librerías y modulos necesarios</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conjunto-de-datos-1"><strong>Conjunto de datos 1</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contextualizacion-de-los-datos"><strong>Contextualización de los datos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#caracteristicas-de-los-datos"><strong>Características de los datos</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformacion-limpieza-y-reorganizacion-del-conjunto-de-datos"><strong>Transformación, limpieza y reorganización del conjunto de datos</strong></a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kanery Marcela Camargo Rodríguez - Sebastian Arteta Padilla
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>